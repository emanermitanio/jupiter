SELECT 
    MAKER_SID, 
    CHECKER_SID, 
    COUNT(*) AS TotalRecords,
    SUM(CASE WHEN MAKER_ANSWER IS NOT NULL AND MAKER_ANSWER != 'None' THEN 1 ELSE 0 END) AS MakerAnswered,
    SUM(CASE WHEN CHECKER_ANSWER IS NOT NULL AND CHECKER_ANSWER != 'None' THEN 1 ELSE 0 END) AS CheckerAnswered,
    printf("%.0f%%", (SUM(CASE WHEN MAKER_ANSWER IS NOT NULL AND MAKER_ANSWER != 'None' THEN 1 ELSE 0 END) * 100.0) / COUNT(*)) AS MAKER_COMPLETION,
    printf("%.0f%%", (SUM(CASE WHEN CHECKER_ANSWER IS NOT NULL AND CHECKER_ANSWER != 'None' THEN 1 ELSE 0 END) * 100.0) / COUNT(*)) AS CHECKER_COMPLETION
FROM 
    TBL_AUDIT
WHERE PIPE_ID = 1
GROUP BY 
    MAKER_SID, 
    CHECKER_SID;
